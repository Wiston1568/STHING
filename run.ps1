if (!(Test-Path ".\adb.exe")) {
    Write-Host "[!] adb.exe not found in current folder." -ForegroundColor Red
    Write-Host "Please add adb.exe to this folder or add it to PATH."
    Pause
    exit
}

Write-Host "?????????????????????????????????????????????????????????????????????????????????????????????"
Write-Host "???     STHING Security Tool     ???"
Write-Host "???  Dev by Bug & wiston1568     ???"
Write-Host "?????????????????????????????????????????????????????????????????????????????????????????????"

function Show-Menu {
    Write-Host ""
    Write-Host "1. ???? Detect MDM"
    Write-Host "2. ???? Remove MDM (Root)"
    Write-Host "3. ???? Read IMEI"
    Write-Host "4. ???? Root Detection"
    Write-Host "5. ???? Full Auto Mode"
    Write-Host "6. ???? Install Magisk Manager"
    Write-Host "7. ???? Chipset Info"
    Write-Host "8. ???? Scan Device Info"
    Write-Host "0. ??? Exit"
}

function Get-Prop($prop) {
    return (& ".\adb.exe" shell getprop $prop).Trim()
}

function Detect-MDM {
    Write-Host "`n???? Scanning for MDM..."
    $packages = & ".\adb.exe" shell pm list packages
    $owner = & ".\adb.exe" shell dpm get-device-owner
    Write-Host "[!] Device Owner Active: $owner"
    Pause
}

function Scan-DeviceInfo {
    Write-Host "`n???? Scanning device info..."
    $chipset = Get-Prop "ro.board.platform"
    $serial = Get-Prop "ro.serialno"
    $manufacturer = Get-Prop "ro.product.manufacturer"
    $model = Get-Prop "ro.product.model"
    $android = Get-Prop "ro.build.version.release"

    Write-Host "[+] Chipset: $chipset"
    Write-Host "[+] Serial: $serial"
    Write-Host "[+] Manufacturer: $manufacturer"
    Write-Host "[+] Model: $model"
    Write-Host "[+] Android: $android"
    Pause
}

do {
    Write-Host ""
    Write-Host "?????????????????????????????????????????????????????????????????????????????????????????????"
    Write-Host "???     STHING Security Tool     ???"
    Write-Host "???  Dev by Bug & wiston1568     ???"
    Write-Host "?????????????????????????????????????????????????????????????????????????????????????????????"
    Show-Menu
    $choice = Read-Host "`n???? Choose an option"

    switch ($choice) {
        "1" { Detect-MDM }
        "8" { Scan-DeviceInfo }
        "0" { exit }
        default { Write-Host "[!] Invalid option. Try again." -ForegroundColor Yellow }
    }
} while ($true)